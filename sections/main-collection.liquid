<div class="collection-container max-w-[1440px] mx-auto px-4 md:px-10 py-12">
  <div class="flex flex-col md:flex-row gap-12">
    <aside class="w-full md:w-64 flex-shrink-0">
      <div class="filter-wrapper sticky top-24">
        <h2 class="text-[14px] uppercase tracking-[0.3em] font-medium mb-8">Filters</h2>

        <form id="CollectionFiltersForm" class="space-y-8">
          {%- for filter in collection.filters -%}
            <div class="filter-group border-b border-gray-100 pb-6">
              <h3 class="text-[12px] uppercase tracking-widest text-gray-400 mb-4">{{ filter.label }}</h3>

              <div class="filter-options {% if filter.label == 'Renk' or filter.label == 'Color' %}grid grid-cols-4 gap-3 w-max{% else %}space-y-2{% endif %}">
                {%- case filter.type -%}
                  {%- when 'list', 'boolean' -%}
                    {%- for value in filter.values -%}
                      {%- if filter.label == 'Renk' or filter.label == 'Color' -%}
                        {% comment %} --- RENK YUVARLAKLARI (SWATCHES) --- {% endcomment %}
                        <label class="relative cursor-pointer group">
                          <input
                            type="checkbox"
                            name="{{ value.param_name }}"
                            value="{{ value.value }}"
                            {% if value.active %}
                              checked
                            {% endif %}
                            class="sr-only peer"
                          >
                          <span
                            class="block w-6 h-6 rounded-full border border-gray-200 ring-offset-2 ring-black peer-checked:ring-1 transition-all"
                            style="background-color: {{ value.label | handle }};"
                          ></span>
                          {% comment %} Tooltip: Üzerine gelince renk adını gösterir {% endcomment %}
                          <span class="absolute -bottom-8 left-1/2 -translate-x-1/2 bg-black text-white text-[8px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10">
                            {{ value.label }}
                          </span>
                        </label>
                      {%- else -%}
                        {% comment %} --- STANDART LİSTE (BOYUT VB.) --- {% endcomment %}
                        <label class="flex items-center gap-3 cursor-pointer group">
                          <input
                            type="checkbox"
                            name="{{ value.param_name }}"
                            value="{{ value.value }}"
                            {% if value.active %}
                              checked
                            {% endif %}
                            {% if value.count == 0 and value.active == false %}
                              disabled
                            {% endif %}
                            class="w-3 h-3 border-gray-300 focus:ring-0 checked:bg-black"
                          >
                          <span class="text-[12px] uppercase tracking-tighter {% if value.count == 0 %}text-gray-300{% endif %}">
                            {{ value.label }}
                            <span class="text-[12px] text-gray-400">({{ value.count }})</span>
                          </span>
                        </label>
                      {%- endif -%}
                    {%- endfor -%}

                  {%- when 'price_range' -%}
                    {% comment %} ... fiyat kodun aynı kalabilir ... {% endcomment %}
                    <div class="filter-price-range space-y-4">
                      <div class="flex items-center gap-4">
                        <div class="relative flex-1">
                          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-[14px] text-gray-400">
                            {{- cart.currency.symbol -}}
                          </span>
                          <input
                            name="{{ filter.min_value.param_name }}"
                            id="Filter-{{ filter.label | handle }}-Min"
                            {% if filter.min_value.value %}
                              value="{{ filter.min_value.value | money_without_currency | replace: '.', '' | replace: ',', '' }}"
                            {% endif %}
                            type="number"
                            placeholder="0"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '' }}"
                            class="w-full pl-7 pr-3 py-2 border border-gray-100 text-[11px] focus:border-black outline-none transition-colors"
                          >
                        </div>

                        <span class="text-gray-300 text-[10px]">—</span>

                        <div class="relative flex-1">
                          <span class="absolute left-3 top-1/2 -translate-y-1/2 text-[14px] text-gray-400">
                            {{- cart.currency.symbol -}}
                          </span>
                          <input
                            name="{{ filter.max_value.param_name }}"
                            id="Filter-{{ filter.label | handle }}-Max"
                            {% if filter.max_value.value %}
                              value="{{ filter.max_value.value | money_without_currency | replace: '.', '' | replace: ',', '' }}"
                            {% endif %}
                            type="number"
                            placeholder="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '' }}"
                            min="0"
                            max="{{ filter.range_max | money_without_currency | replace: '.', '' | replace: ',', '' }}"
                            class="w-full pl-7 pr-3 py-2 border border-gray-100 text-[11px] focus:border-black outline-none transition-colors"
                          >
                        </div>
                      </div>

                      {% comment %} Alt kısma lüks bir bar görüntüsü ekleyelim {% endcomment %}
                      <div class="relative w-full h-[1px] bg-gray-100 mt-6">
                        <div class="absolute inset-0 bg-black" style="left: 0%; right: 0%;"></div>
                        <div class="absolute -left-1 -top-[2px] w-[5px] h-[5px] rounded-full bg-black"></div>
                        <div class="absolute -right-1 -top-[2px] w-[5px] h-[5px] rounded-full bg-black"></div>
                      </div>
                    </div>
                {%- endcase -%}
              </div>
            </div>
          {%- endfor -%}

          <div class="pt-4">
            <a
              href="{{ collection.url }}?sort_by={{ collection.sort_by }}"
              class="text-[9px] uppercase underline tracking-widest"
              >Clear All</a
            >
          </div>
        </form>
      </div>
    </aside>

    <main id="ProductGridContainer" class="flex-grow">
      <div class="grid grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-12">
        {% for product in collection.products %}
          {% render 'product-card', product: product %}
        {% else %}
          <p class="text-center py-20 text-[12px] uppercase tracking-widest">No products found.</p>
        {% endfor %}
      </div>

      {% if paginate.pages > 1 %}
        <div class="pagination mt-20 flex justify-center border-t pt-10">
          {{ paginate | default_pagination }}
        </div>
      {% endif %}
    </main>
  </div>
</div>

{% schema %}
{
  "name": "Collection Page",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "label": "Products per page",
      "min": 8,
      "max": 24,
      "step": 4,
      "default": 12
    }
  ]
}
{% endschema %}
